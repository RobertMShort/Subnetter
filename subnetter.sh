#!/bin/bash

echo "SUBNETTER"
echo "---------------------"

echo "Enter ip with CIDR notation: "

read ip

declare -A subnetmask
subnetmask=([16]=255.255.0.0 [17]=255.255.128.0 [18]=255.255.192.0 [19]=255.255.224.0 [20]=255.255.240.0 [21]=255.255.248.0 
[22]=255.255.252.0 [23]=255.255.254.0 [24]=255.255.255.0 [25]=255.255.255.128 [26]=255.255.255.192 [27]=255.255.255.224 
[28]=255.255.255.240 [29]=255.255.255.248 [30]=255.255.255.252)

declare -A binary
binary=([16]=11111111.11111111.00000000.00000000 [17]=11111111.11111111.10000000.00000000 [18]=11111111.11111111.11000000.00000000 
[19]=11111111.11111111.11100000.00000000 [20]=11111111.11111111.11110000.00000000 [21]=11111111.11111111.11111000.00000000 
[22]=11111111.11111111.11111100.00000000 [23]=11111111.11111111.11111110.00000000 [24]=11111111.11111111.11111111.00000000 
[25]=11111111.11111111.11111111.10000000 [26]=11111111.11111111.11111111.11000000 [27]=11111111.11111111.11111111.11100000 
[28]=11111111.11111111.11111111.11110000 [29]=11111111.11111111.11111111.11111000 [30]=11111111.11111111.11111111.11111100)

CIDR=${ip: -2}

hosts=$(echo "${binary[$CIDR]}" | grep -o '0' | wc -l)
networks=$(echo ${binary[$CIDR]: -8} | grep -o '1' | wc -l)

if [ -v subnetmask[$CIDR] ]; then
        echo "Subnet Mask: ${subnetmask[$CIDR]}"
        echo "Subnet Binary: ${binary[$CIDR]}"
        echo "IP Addresses: "$((2**"$hosts"))
        echo "Usable IP Addresses: "$((2**"$hosts"-2))
        echo "Networks: "$((2**"$networks"))
fi
